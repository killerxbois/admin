<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NonLiveTV Admin Panel</title>
    <style>
        body {
            font-family: Arial;
            background: #111;
            color: #fff;
            padding: 20px;
        }
        input, button, select {
            padding: 10px;
            margin: 5px;
            width: 100%;
            max-width: 400px;
        }
        h1 {
            color: red;
        }
        .channel {
            background: #222;
            padding: 10px;
            margin: 5px 0;
        }
    </style>
</head>

<body>

    <h1>NonLiveTV Admin Panel</h1>

    <div id="login">
        <h3>Enter Admin Password:</h3>
        <input type="password" id="password" placeholder="Admin Password">
        <button onclick="checkPassword()">Login</button>
    </div>

    <div id="panel" style="display:none;">
        <h2>Add Channel</h2>
        <input type="text" id="title" placeholder="Channel Title">
        <input type="text" id="category" placeholder="Category (Movies, Sports, etc)">
        <input type="text" id="thumbnail" placeholder="Thumbnail URL">
        <input type="text" id="stream" placeholder="M3U8 Stream URL">
        <button onclick="addChannel()">Add Channel</button>

        <h2>All Channels</h2>
        <div id="channels"></div>

        <h2>Danger Zone</h2>
        <button onclick="clearFavorites()">Clear All Favorites</button>
    </div>

    <script>
        const API = "https://sheetdb.io/api/v1/5pgfrwklxip2x";
        const adminPass = "1234"; // Change this to your own password

        function checkPassword() {
            if(document.getElementById('password').value === adminPass){
                document.getElementById('login').style.display = 'none';
                document.getElementById('panel').style.display = 'block';
                loadChannels();
            } else {
                alert("Incorrect Password!");
            }
        }

        function loadChannels() {
            fetch(API)
                .then(res => res.json())
                .then(data => {
                    let html = "";
                    data.forEach((ch, i) => {
                        html += `
                            <div class="channel">
                                <b>${ch.title}</b> [${ch.category}]<br>
                                <small>${ch.stream}</small><br>
                                <button onclick="deleteChannel('${ch.id}')">Delete</button>
                            </div>
                        `;
                    });
                    document.getElementById("channels").innerHTML = html;
                });
        }

        function addChannel() {
            const title = document.getElementById("title").value;
            const category = document.getElementById("category").value;
            const thumbnail = document.getElementById("thumbnail").value;
            const stream = document.getElementById("stream").value;

            if (!title || !category || !thumbnail || !stream) return alert("All fields are required!");

            fetch(API, {
                method: "POST",
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ data: { title, category, thumbnail, stream } })
            }).then(() => {
                alert("Channel Added!");
                loadChannels();
            });
        }

        function deleteChannel(id) {
            fetch(API + '/id/' + id, { method: "DELETE" })
                .then(() => {
                    alert("Channel Deleted!");
                    loadChannels();
                });
        }

        function clearFavorites() {
            localStorage.removeItem('favorites');
            alert("All Favorites Cleared!");
        }
    </script>
</body>

</html>